CREATE TABLE WorkerSWA (
  WORKER_ID INTEGER PRIMARY KEY,
  FIRST_NAME TEXT NOT NULL,
  LAST_NAME TEXT NOT NULL,
  SALARY INTEGER NOT NULL,
  JOINING_DATE TEXt NOT NULL,
  DEPARTMENT TEXT NOT NULL
);
INSERT INTO WorkerSWA( WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT)
VALUES(1,"Monika","Arora",100000,"2014-02-20 09:00:00","HR"),
(2,"Niharika","Verma",80000,"2014-06-11 09:00:00","Admin"),
(3,"Vishal","Singhal",300000,"2014-02-20 09:00:00","HR"),
(4,"Amitabh","Singh",500000,"2014-02-20 09:00:00","Admin"),
(5,"Vivek","Bhati",500000,"2014-06-11 09:00:00","Admin"),
(6,"Vipul","Diwan",200000,"2014-06-11 09:00:00","Account"),
(7,"Satish","Kumar",75000,"2014-01-20 09:00:00","Account"),
(8,"Geetika","Chauhan",90000,"2014-04-11 09:00:00","Admin");
SELECT * FROM WorkerSWA;

CREATE TABLE BonusSWA (
  WORKER_REF_ID INTEGER PRIMARY KEY,
  BONUS_DATE TEXT NOT NULL,
  BONUS_AMOUNT INTEGER NOT NULL);
INSERT INTO BonusSWA( WORKER_REF_ID,BONUS_DATE,BONUS_AMOUNT)
VALUES(1,"2016-02-20 00:00:00", 5000),
(2,"2016-06-11 00:00:00", 3000),
(3,"2016-02-20 00:00:00", 4000),
(4,"2016-02-20 00:00:00", 4500),
(5,"2016-06-11 00:00:00", 3500);
SELECT * FROM BonusSWA;

CREATE TABLE TitleSWA (
  WORKER_REF_ID INTEGER PRIMARY KEY,
  WORKER_TITLE TEXT NOT NULL,
  AFFECTED_FROM TEXT NOT NULL);
INSERT INTO TitleSWA( WORKER_REF_ID,WORKER_TITLE,AFFECTED_FROM)
VALUES(1,"Manager","2016-02-20 00:00:00"),
(2,"Executive","2016-06-11 00:00:00"),
(8,"Executive","2016-06-11 00:00:00"),
(5,"Manager","2016-06-11 00:00:00"),
(4,"Asst.Manager","2016-06-11 00:00:00"),
(7,"Executive","2016-06-11 00:00:00"),
(6,"Lead","2016-06-11 00:00:00"),
(3,"Lead","2016-06-11 00:00:00");
SELECT * FROM TitleSWA;

--Q1:
SELECT * FROM WorkerSWA
WHERE DEPARTMENT = "Admin";

--Q2:
SELECT * FROM WorkerSWA
WHERE FIRST_NAME LIKE "%a%";

--Q3:
SELECT * FROM WorkerSWA
WHERE FIRST_NAME LIKE "%a";

--Q4:
SELECT * FROM WorkerSWA
WHERE FIRST_NAME LIKE '_____h';

--Q5:
SELECT COUNT(*) AS WorkersCount
FROM WorkerSWA
WHERE Department = 'Admin';

--Q6:
SELECT FIRST_NAME || ' ' || LAST_NAME AS WORKER_NAME
FROM WorkerSWA
WHERE SALARY >= 50000 AND SALARY <= 100000;

--Q7:
SELECT DEPARTMENT, COUNT(*) AS WorkerCount
FROM WorkerSWA
GROUP BY DEPARTMENT
ORDER BY WorkerCount DESC;

--Q8:
SELECT DISTINCT W.FIRST_NAME, T.WORKER_TITLE
FROM WorkerSWA W
INNER JOIN TitleSWA T
ON W.WORKER_ID = T.WORKER_REF_ID
AND T.WORKER_TITLE in ('Manager');

--Q9:
SELECT WORKER_TITLE, AFFECTED_FROM, COUNT(*)
FROM TitleSWA
GROUP BY WORKER_TITLE, AFFECTED_FROM
HAVING COUNT(*) > 1;

--Q10:
SELECT * FROM WorkerSWA WHERE WORKER_ID & 1 = 1;

--Q11:
SELECT * FROM WorkerSWA WHERE WORKER_ID & 1 = 0;

--Q12:
SELECT * FROM WorkerSWA ORDER BY Salary DESC LIMIT 10;

--Q13:
SELECT Salary FROM WorkerSWA ORDER BY Salary DESC LIMIT 5-1,1;

--Q14:
SELECT Salary
FROM WorkerSWA W1
WHERE 4 = (
 SELECT COUNT( DISTINCT ( W2.Salary ) )
 FROM WorkerSWA W2
 WHERE W2.Salary >= W1.Salary
 );
 
--Q15:
 Select distinct W.WORKER_ID, W.FIRST_NAME, W.Salary 
from WorkerSWA W, WorkerSWA W1 
where W.Salary = W1.Salary 
and W.WORKER_ID != W1.WORKER_ID;

--Q16:
SELECT *
FROM WorkerSWA
WHERE WORKER_ID <= (SELECT count(WORKER_ID)/2 from WorkerSWA);

--Q17:
SELECT DEPARTMENT, COUNT(WORKER_ID) AS 'Number of Workers'
FROM WorkerSWA 
GROUP BY DEPARTMENT 
HAVING COUNT(WORKER_ID) < 5;

--Q18:
SELECT t.DEPARTMENT,t.FIRST_NAME,t.Salary
FROM(SELECT max(Salary)AS TotalSalary,DEPARTMENT
FROM WorkerSWA 
GROUP BY DEPARTMENT) AS TempNew 
Inner JOIN WorkerSWA t ON TempNew.DEPARTMENT=t.DEPARTMENT AND TempNew.TotalSalary=t.Salary;

--Q19:
SELECT DEPARTMENT, SUM (Salary)
FROM workerSWA GROUP BY DEPARTMENT;

--Q20:
SELECT FIRST_NAME, SALARY
FROM WorkerSWA 
WHERE SALARY=(SELECT max(SALARY) FROM WorkerSWA);
